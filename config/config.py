import torch
from torchvision import transforms

config = {
    'data_path': r'data/raw',   # Path of windows PE files
    'img_path': r'data/img',    # Path of output images
    'need_convert': False,      # Need convert PE file to image or not
    'check_file': False,        # Check if the input is a PE file
    'cuda_idx': 3,              # 
    'num_class': 6,             # Numbers of malware classes
    'split_rate': 0.7,          # #<train data> / #<total data>
    'num_epochs': 20,           # TODO: change to 50
    'batch_size': 32,
    'learning_rate': 5e-6,
    'momentum': 0.9,
    'weight_decay': 1,
    'num_workers': 4,
}

device = f'cuda:{config["cuda_idx"]}' if torch.cuda.is_available() else 'cpu'

data_transforms = {
    'train': transforms.Compose([
        transforms.RandomResizedCrop(224),
        transforms.RandomHorizontalFlip(),
        transforms.ToTensor(),
        transforms.Normalize([0.485, 0.456, 0.406], [0.229, 0.224, 0.225])
    ]),
    'val': transforms.Compose([
        transforms.Resize(256),
        transforms.CenterCrop(224),
        transforms.ToTensor(),
        transforms.Normalize([0.485, 0.456, 0.406], [0.229, 0.224, 0.225])
    ]),
}
