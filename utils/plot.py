import matplotlib.pyplot as plt
import numpy as np
import argparse
import sys
sys.path.append('./')
from config.cfgs import cfgs


if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('--steps', type=int, default=50)
    args = parser.parse_args()
    
    steps = args.steps
    train_loss = np.load(f'{cfgs["save_data_path"]}/vgg_train_loss_{steps}.npy')
    val_loss = np.load(f'{cfgs["save_data_path"]}/vgg_val_loss_{steps}.npy')
    train_acc = np.load(f'{cfgs["save_data_path"]}/vgg_train_acc_{steps}.npy')
    val_acc = np.load(f'{cfgs["save_data_path"]}/vgg_val_acc_{steps}.npy')
    
    plt.figure(figsize=(8, 6))
    plt.plot(train_loss, label='Training loss')
    plt.plot(val_loss, label='Testing loss')
    plt.legend()
    plt.savefig(f'{cfgs["save_img_path"]}/loss_{steps}.png')

    plt.figure(figsize=(8, 6))
    plt.plot(train_acc, label='Training accuracy')
    plt.plot(val_acc, label='Testing accuracy')
    plt.legend()
    plt.savefig(f'{cfgs["save_img_path"]}/acc_{steps}.png')